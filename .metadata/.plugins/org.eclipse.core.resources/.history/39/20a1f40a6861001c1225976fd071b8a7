<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="payMapper">

<insert id="insertPay">
insert into pay(pay_no,pay_method,pay_date)
values(#{pay_no},#{pay_method}, sysdate)
</insert>

<select id="selectPay" resultMap="select_re">
select * from pay order by pay_no desc
</select>
<resultMap type="Pay" id="select_re">
<result column="PAY_NO" property="pay_no"/>
<result column="PAY_METHOD" property="pay_method"/>
<result column="PAY_DATE" property="pay_date"/>
</resultMap>

<update id="updatePay">
update pay set pay_method=#{pay_method} where pay_no=#{pay_no}
</update>

<delete id="deletePay">
delete from pay where pay_no=#{pay_no}
</delete>

<select id="selectOne" resultMap="select_re">
select * from pay where pay_no=#{pay_no}
</select>

<!-- 새 코딩 시작 -->

<select id="cartItem" resultMap="cart_item">
select * from cart_item
inner join cart
on cart_item.cart_no=cart.cart_no
where cart.mem_id=#{mem_id}
</select>
<resultMap type="Cart_item" id="cart_item">
<result column="cart_item_no" property="cart_item_no"/>
<result column="cart_amount" property="cart_amount"/>
<result column="cart_no" property="cart_no"/>
<result column="item_code" property="item_code"/>
</resultMap>

<select id="cartList" resultMap="cart_list">
select item_name, item_price, cart_amount, cart_item_no, cart_no, item_code from cart_item
inner join item
on cart_item.item_code=item.item_code
where cart_item.item_code=#{item_code}
</select>
<resultMap type="kr.co.ezenac.pay.model.vo.CartListVO" id="cart_list">
<result column="item_name" property="item_name"/>
<result column="item_price" property="item_price"/>
<result column="cart_amount" property="cart_amount"/>
<result column="cart_item_no" property="cart_item_no"/>
<result column="cart_no" property="cart_no"/>
<result column="item_code" property="item_code"/>
</resultMap>

<select id="img">
select img_name from Images where img_ref="item" and img_id=#{item_code}
</select>
</mapper>